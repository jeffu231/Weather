/*
 * grunt-tomcat-deploy
 * https://github.com/elebescond/grunt-tomcat-deploy
 *
 * Copyright (c) 2013 Erwan Le Bescond
 * Licensed under the MIT license.
 */

'use strict';

module.exports = function(grunt) {

	grunt.registerTask('tomcat_war_only', 'Deploy your files to a tomcat server.', function() {
		grunt.log.writeln(['In war']);
	  var tomcat = grunt.config('tomcat_deploy');
	  if(tomcat === undefined){
		  grunt.log.writeln(['config empty:' + grunt]);
		  return;
	  }
	    
	  var archive = tomcat.dist + '.war';
	  grunt.log.writeln(['In war before load zip']);
	  grunt.loadNpmTasks('grunt-zip');
	  
	  grunt.config('zip', {
	    war: {
	      cwd: tomcat.dist,
	      dest: archive,
	      src: [tomcat.dist + '/**']
	    }
	  });
	  
	  grunt.task.run([ 'zip:war']);
	});
	
	grunt.registerTask('tomcat_war', [ 'tomcat_war_only']);

};

